export LANG=en_US.UTF-8
export EDITOR='nvim'
export DOTFILES=$HOME/.dotfiles

source $DOTFILES/wtg/env

prependPath() {
  if [[ -d "$1" ]] && [[ ":$PATH:" != *":$1:"* ]]; then
    PATH="$1:$PATH"
  fi
}

appendPath() {
  if [[ -d "$1" ]] && [[ ":$PATH:" != *":$1:"* ]]; then
    PATH="$PATH:$1"
  fi
}

export HOMEBREW_PREFIX=`/opt/homebrew/bin/brew --prefix`
HOMEBREW_BIN=$HOMEBREW_PREFIX/bin:$HOMEBREW_PREFIX/sbin

prependPath HOMEBREW_BIN

PERSONAL=$DOTFILES/personal/env
for i in `find -L $PERSONAL`; do
  source $i
done

source $DOTFILES/zsh/fzf.zsh

# Case insensitive.
zstyle ':completion:*' matcher-list 'm:{[:lower:][:upper:]}={[:upper:][:lower:]}' 'm:{[:lower:][:upper:]}={[:upper:][:lower:]} l:|=* r:|=*' 'm:{[:lower:][:upper:]}={[:upper:][:lower:]} l:|=* r:|=*' 'm:{[:lower:][:upper:]}={[:upper:][:lower:]} l:|=* r:|=*'

switch() {
  if [[ -z "$1" ]]; then
    selected = echo "personal wtg" | tr ' ' '\n' | fzf
  else
    selected = $1
  fi

  if [[ "$selected" == "personal" ]]; then
    if [[ -f $DOTFILES/personal/npmrc ]]; then
      cp $DOTFILES/personal/.npm-personal-rc ~/.npmrc
    fi
    if [[ -f $DOTFILES/personal/ssh/config ]]; then
      cp $DOTFILES/personal/ssh/config ~/.ssh/config
    fi
  elif [[ "$selected" == "wtg" ]]; then
    if [[ -f $DOTFILES/wtg/npmrc ]]; then
      cp $DOTFILES/wtg/.npm-wtg-rc ~/.npmrc
    fi
    if [[ -f $DOTFILES/wtg/ssh/config ]]; then
      cp $DOTFILES/wtg/ssh/config ~/.ssh/config
    fi
  fi
}

switch "personal"
